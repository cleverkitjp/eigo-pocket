<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>えいごポケット</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="page">
    <!-- タイトルカード -->
    <header class="title-card">
      <h1 class="app-title">えいごポケット</h1>
      <p class="app-subtitle">カードをめくって、スタンプを集めよう。</p>

      <div class="stage-area">
        <div class="stage-label">ステージ</div>
        <div id="stage-strip" class="stage-strip" aria-label="ステージをえらぶ"></div>
      </div>
    </header>

    <!-- 現在ステージ表示（タイトルとカードの間） -->
    <div id="current-stage" class="current-stage">ステージ｜-</div>

    <!-- 単語カード -->
    <section class="learn-card">
      <div class="learn-top">
        <div id="progress" class="progress">0/0</div>
        <div id="tap-hint" class="tap-hint">タップしてカードをめくる</div>
      </div>

      <button id="flip-card" class="flip-card" type="button" aria-label="カードをめくる">
        <div class="flip-inner" id="flip-inner">
          <!-- 表：えいご + はつおん -->
          <div class="flip-face flip-front">
            <div id="front-english" class="front-english">loading...</div>
            <div id="front-kana" class="front-kana"></div>
          </div>

          <!-- 裏：にほんご -->
          <div class="flip-face flip-back">
            <div id="back-japanese" class="back-japanese"></div>
          </div>
        </div>
      </button>

      <div class="nav-row">
        <button id="prev-btn" class="nav-btn nav-prev" type="button">◀ まえへ</button>
        <button id="next-btn" class="nav-btn nav-next" type="button">つぎへ ▶</button>
      </div>
    </section>

    <!-- スタンプ / ミニテスト -->
    <section class="stamp-card">
      <div id="remaining-to-test" class="remaining-to-test">あと10まいおぼえたらミニテストだよ</div>

      <!-- ミニテストは「権利獲得後」ここに出現 -->
      <div id="mini-test-area" class="mini-test-area hidden">
        <div class="mini-test-msg">ぜんもんせいかいでスタンプがもらえるよ</div>
        <button id="mini-test-btn" class="mini-test-btn" type="button">ミニテストをする（3問）</button>
      </div>

      <div class="stamp-box stamp-today">
        <div class="stamp-title">きょうのスタンプ（1日10こまで）</div>
        <div id="today-stamps" class="stamp-stars">☆☆☆☆☆☆☆☆☆☆</div>
      </div>

      <div class="stamp-box stamp-total">
        <div class="stamp-title">あつめたスタンプ</div>
        <div class="stamp-total-row">
          <div class="stamp-total-num">
            <span id="total-stamps">0</span><span class="stamp-unit">こ</span>
          </div>
          <div class="stamp-badges">
            <span id="rank-title" class="badge">ひよこ</span>
            <span id="rank-level" class="badge badge-level">Lv.1</span>
          </div>
        </div>
      </div>
    </section>

    <!-- おうちのかたへ -->
    <section class="info-card">
      <h2 class="info-title">おうちのかたへ</h2>
      <ul class="info-list">
        <li>このツールは、主に小学生向けに作りました。</li>
        <li>中学校での英語学習にむけて覚えておきたい英単語やフレーズを収録しています。</li>
      </ul>
    </section>

    <!-- 共有フッター -->
    <div id="shared-footer" class="shared-footer"></div>
  </div>

  <!-- ミニテスト（モーダル） -->
  <div id="test-overlay" class="test-overlay hidden" role="dialog" aria-modal="true" aria-label="ミニテスト">
    <div class="test-modal">
      <div class="test-head">
        <div class="test-title">ミニテスト（3問）</div>
        <button id="test-close" class="test-close" type="button" aria-label="閉じる">✕</button>
      </div>

      <div id="test-body" class="test-body">
        <!-- JSで生成 -->
      </div>

      <div class="test-foot">
        <button id="test-submit" class="test-submit" type="button">答え合わせ</button>
      </div>
    </div>
  </div>

  <script src="app.js?v=2"></script>
  <script>
    // cleverkitjp 共有footer（全ツール共通）
    (function(){
      const el = document.getElementById('shared-footer');
      const url = 'https://cleverkitjp.github.io/footer.html';
      fetch(url, { cache: 'no-cache' })
        .then(r => r.text())
        .then(html => { el.innerHTML = html; })
        .catch(() => { el.innerHTML = '<div class="footer-fallback">cleverkitjp</div>'; });
    })();
  </script>
</body>
</html>
